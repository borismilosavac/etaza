# Zgrada Plus — Modul **Obavještenja** (*Notifications*) — AI‑readable frontend specifikacija (Flutter Mobile + Web)

> [!IMPORTANT]
> Jedinstveni dokument za dizajn i implementaciju frontenda modula **Obavještenja** (*Notifications*) za role **Stanar** (*Resident*) i **Upravnik** (*Manager*), sa jasnom separacijom **Freemium** (*Freemium*) i **Premium** (*Premium*). Napisano za AI modele (UI/UX + implementacija), dizajnere i developere.

---

## 0) **Operativna pravila** (*Operating rules*)

1. **Determinističko ponašanje** (*Deterministic behavior*): svaki klik/tap vodi u definisan ishod, sa jasno definisanim stanjima.
2. **Nema oslanjanja na email/telefon** (*No dependency on email/phone*): oba su opcionalna; osnovne funkcije moraju raditi bez njih.
3. **Upravnik Web = pun set** (*Manager Web = full set*), **Upravnik Mobile = podskup** (*subset*).
4. **WCAG 2.1 AA** (*WCAG 2.1 AA*) obavezno: kontrast, fokus, tastatura, screen reader, font scaling.
5. **Plan i prava** (*Plan & entitlements*) dolaze sa servera u produkciji; dev/prototip ima **Prekidač plana** (*Plan toggle*).
6. **Privatnost poruka** (*Private threads*): poruke stanara su privatne po obavještenju; nema javnog komentarisanja u v1.

---

## 1) **Uloge, planovi, platforme** (*Roles, plans, platforms*)

### 1.1 **Uloge** (*Roles*)

* **Stanar** (*Resident*): pregled feeda, filtriranje, čitanje detalja, preuzimanje priloga, **Potvrda prijema** (*Acknowledge*), privatna poruka upravniku.
* **Upravnik** (*Manager*): kreiranje, uređivanje, zakazivanje, objava, povlačenje, arhiva, ciljanje segmenata, upravljanje porukama više stanara, (premium) analitika, automatizacije, rekurentno zakazivanje.

### 1.2 **Planovi** (*Plans*)

* **Freemium** (*Freemium*): obavezno omogućava normalno funkcionisanje zgrade.
* **Premium** (*Premium*): dodaje napredne funkcije bez blokiranja osnovnih.

### 1.3 **Platforme** (*Platforms*)

* **Stanar**: **Mobilna** (*Mobile*) primarno, **Web** (*Web*) sekundarno.
* **Upravnik**: **Web** primarno, **Mobilna** sekundarno (brzi pregled i odgovori).

---

## 2) **Entitlements, plan switch, feature flags** (*Entitlements, plan switch, feature flags*)

### 2.1 **Prekidač plana** (*Plan toggle*) — dev/prototip

* UI komponenta: `SegControl` ili `Switch` sa labelima: **Freemium** (*Freemium*) / **Premium** (*Premium*).
* Implementacija: `FeatureFlags.plan = free|premium`.
* Produkcija: komponenta skrivena.

### 2.2 **Pravila prikaza premium elemenata** (*Premium visibility rules*)

* Premium-only funkcije u freemium:

  * ili **skriveno** (*hidden*),
  * ili **onemogućeno** (*disabled*) sa **Premium** (*Premium*) badge + tooltip.
* Osnovne funkcije nikad ne smiju biti blokirane.

### 2.3 **Feature flags** (*Feature flags*)

Minimalni set:

* `ff.notice.analytics`
* `ff.notice.recurringSchedule`
* `ff.notice.smsFallback`
* `ff.notice.exportPdf`
* `ff.notice.versioning`
* `ff.notice.importantMark`
* `ff.notice.serverArchive`
* `ff.notice.inlinePdfPreview`
* `ff.notice.offlineQueue`

---

## 3) **Domenski model** (*Domain model*) — kompletan skup atributa

### 3.1 Entitet: **Obavještenje** (*Notice*)

**Atributi (minimalni + prošireni):**

* `id: String`
* `buildingId: String`
* `title: String`
* `subtitle: String?` (kratko pojašnjenje)
* `bodyMd: String` (Markdown)
* `summary: String?` (automatski ili ručno; za list view)
* `attachments: Attachment[]`
* `priority: normal | urgent`
* `category: general | maintenance | finance | safety | meeting | outage | other` (label-only u v1)
* `tags: String[]` (upravnik)
* `requiresAck: bool`
* `ackDeadlineAt: DateTime?` (premium)
* `ackCount: int` (server)
* `readCount: int` (premium server stats)
* `replyCount: int`
* `newRepliesCount: int` (upravnik)
* `pinMode: none | until | permanent` (permanent premium)
* `pinUntil: DateTime?`
* `status: draft | scheduled | published | retracted | archived`
* `visibility: building | segment | unit` (public within allowed scope)
* `targeting: Targeting`
* `channels: Channels`
* `deliveryState: DeliveryState` (server computed; premium detail)
* `language: String` (npr. `sr-Latn`, `sr-Cyrl`, `en`)
* `createdById: String`
* `createdByRole: manager`
* `createdAt: DateTime`
* `updatedAt: DateTime`
* `publishedAt: DateTime?`
* `scheduleAt: DateTime?`
* `recurrence: RecurrenceRule?` (premium)
* `retractedAt: DateTime?`
* `archivedAt: DateTime?`
* `editedAt: DateTime?`
* `editVersion: int` (optimistic locking)
* `source: SourceRef?` (ako je sistemski generisano)
* `links: LinkRef[]` (npr. “Vidi dokument”, “Vidi kvar”)
* `flags: NoticeFlags`

**NoticeFlags (bool):**

* `isPinned`
* `isUrgent`
* `hasAttachments`
* `requiresAck`
* `isEdited`
* `isFromTemplate` (premium)
* `isVersioned` (premium)

### 3.2 Entitet: **Poruka** (*Message*)

* `id: String`
* `noticeId: String`
* `threadId: String` (po stanaru per obavještenje)
* `fromRole: resident | manager`
* `fromId: String`
* `fromUnitId: String?` (resident)
* `fromUnitLabel: String` (npr. “B‑204”) — obavezno za prikaz bez PII
* `fromDisplayName: String?` (ako postoji ime u profilu)
* `text: String`
* `attachments: Attachment[]`
* `createdAt: DateTime`
* `editedAt: DateTime?` (premium; v1 može biti disabled)
* `deletedAt: DateTime?` (soft delete; v1 default disabled)
* `delivery: MessageDeliveryState` (sent/failed/pending)
* `readByManagerAt: DateTime?`
* `readByResidentAt: DateTime?`

### 3.3 Entitet: **Thread** (*Conversation thread*)

* `id: String`
* `noticeId: String`
* `unitId: String`
* `unitLabel: String`
* `lastMessageAt: DateTime`
* `lastMessageSnippet: String`
* `unreadForManagerCount: int`
* `unreadForResidentCount: int`
* `status: open | closed` (upravnik može zatvoriti)
* `assignedToId: String?` (premium; opcionalno)

### 3.4 Entitet: **Read/Ack** (*Read/Ack receipts*)

* `noticeId`
* `userId`
* `readAt: DateTime?`
* `ackAt: DateTime?`
* `ackMethod: button | auto` (auto samo premium ako uvede)

### 3.5 Entitet: **Attachment** (*Attachment*)

* `id`
* `name`
* `mime`
* `sizeBytes`
* `url`
* `thumbUrl?`
* `type: image | pdf | video | other`
* `width?`, `height?`, `durationSec?`
* `checksum?` (premium)
* `scanStatus: clean | flagged | unknown` (premium; UI samo indikator)

### 3.6 Entitet: **Targeting** (*Targeting*)

* `buildingId` (required)
* `entranceIds[]?`
* `floorNumbers[]?`
* `groupIds[]?`
* `unitIds[]?`
* `audienceCountEstimate: int?` (server)
* `excludeUnitIds[]?` (premium)

### 3.7 Entitet: **Channels** (*Delivery channels*)

* `inApp: true`
* `push: bool`
* `email: bool`
* `sms: bool` (premium)
* `digest: none | daily | weekly` (premium, upravnik)

### 3.8 Entitet: **DeliveryState** (*Delivery status*) — premium

* `pushEligibleCount`
* `pushSentCount`
* `emailEligibleCount`
* `emailSentCount`
* `smsEligibleCount`
* `smsSentCount`
* `failedCount`

---

## 4) **Rute, navigacija, deep link** (*Routes, navigation, deep links*)

### 4.1 Stanar

* `/notifications` — lista
* `/notifications/:id` — detalj

### 4.2 Upravnik

* `/notifications` — upravljačka lista
* `/notifications/new` — wizard
* `/notifications/:id` — detalj + threads
* `/notifications/:id/edit` — edit (draft/scheduled po pravilima)

### 4.3 Deep link pravila

* Pristup provjera targetinga; ako nije u targetingu → ekran **Nedostupno** (*Not available*).
* Nakon otvaranja detalja: set **Pročitano** (*Read*) nakon `>=2s` ili `>=60% scroll`.
* Otvaranje iz push/email/sms nosi parametre: `source=push|email|sms|inapp`.

---

## 5) **Globalne UI konvencije** (*Global UI conventions*)

### 5.1 Layout i responsive

* **Mobilna**: jedna kolona; sticky bottom actions.
* **Web**:

  * lista + detalj (master-detail) kada širina > 1024px,
  * samo lista (narrow web) kada ≤ 1024px,
  * sidebar filter/stats na ≥ 1280px.

### 5.2 Standardni UI elementi

* **Kartica obavještenja** (*Notice card*)
* **Badge** (*Badge*): Novo, Hitno, Pin, Potvrda, Premium, Draft, Scheduled
* **Chip** (*Chip*): filter chips, targeting chips
* **Overlay filter** (*Filter overlay*), **Drawer panel** (*Filter panel*)
* **Search input** (*Search*) + debounced query
* **Context menu** (*Context menu*)
* **Bulk selection bar** (*Bulk action bar*)
* **Bottom sheet** (*Bottom sheet*)
* **Dialog potvrde** (*Confirm dialog*)
* **Snackbar** (*Snackbar*) + **Inline error** (*Inline error*)
* **Skeleton** (*Skeleton loader*)
* **Empty state** (*Empty state*)

### 5.3 Standardne tipografije i truncation

* Kartica naslov max 2 linije; `…` truncation.
* Meta line max 1 linija.
* Body markdown: standard heading scale + list spacing.

---

## 6) **Sortiranje, grupisanje, paginacija** (*Sorting, grouping, pagination*)

### 6.1 Stanar — default sort

Slojevi (od vrha):

1. **Pinovana hitna** (*Pinned urgent*)
2. **Hitna** (*Urgent*)
3. **Važna** (*Important*) (premium; user mark)
4. **Nepročitana** (*Unread*)
5. **Pročitana** (*Read*)
6. **Arhiva** (*Archived*) (samo uz filter)

Datum:

* `scheduled` → `scheduleAt`
* `published` → `publishedAt`
* `archived` → `archivedAt` (fallback `publishedAt`)

Smjer: `DESC`. Tie-breaker: `id DESC`.

### 6.2 Upravnik — default sort

Slojevi:

1. **Nacrt** (*Draft*) — `updatedAt DESC`
2. **Zakazano** (*Scheduled*) — `scheduleAt ASC`
3. **Objavljeno** (*Published*) — `publishedAt DESC`
4. **Povučeno** (*Retracted*) — `retractedAt DESC`
5. **Arhiva** (*Archived*) — `archivedAt DESC`

Boost unutar sloja:

* `newRepliesCount > 0` ide gore (ne prelazi sloj).

### 6.3 Paginacija

* Feed: **infinite scroll** (*infinite scroll*) + `pageSize=20`.
* Pull-to-refresh: re-fetch first page + merge stable.
* Web: virtualized list ako > 200 items.

---

## 7) **STANAR — Lista obavještenja** (*Resident list*)

### 7.1 Frame: Mobile

**AppBar**:

* Title: **Obavještenja** (*Notifications*)
* Actions: **Pretraga** (*Search*), **Filter** (*Filter*)

**Body**:

* `ListView` kartica
* Sekcija pinovanih (ako postoji)

**Floating UI**:

* Unread counter chip: “Nepročitano: N”

### 7.2 Frame: Web

* Header: title + search field + filter button
* Optional left filter panel

### 7.3 Komponenta: **NoticeCard** (*Notice card*) — kompletni elementi

Elementi:

* `title`
* `summary` (1–2 linije; ako nema, generiše se iz body)
* Meta: datum + targeting summary (ulaz/sprat/grupa)
* Badges:

  * **Novo** (*New*) = unread
  * **Hitno** (*Urgent*)
  * **Potvrda** (*Ack required*)
  * **Pin** (*Pinned*)
  * **Uređeno** (*Edited*)
* Indicators:

  * attachment icon + count
  * reply icon + count

Interakcije:

* Tap/click → detalj
* Long press / right click → context menu

### 7.4 Context menu (Stanar)

* **Označi pročitano** (*Mark as read*) / **Označi nepročitano** (*Mark as unread*)
* **Arhiviraj** (*Archive*)
* **Pinuj lično** (*Personal pin*) (premium; lokalno)
* **Označi važno** (*Mark important*) (premium)

### 7.5 Filter UI (Stanar)

Filter overlay/panel sadrži:

* Status chips: **Sve** (*All*), **Nepročitano** (*Unread*), **Pročitano** (*Read*), **Hitno** (*Urgent*), **Potvrda** (*Ack required*), **Sa prilozima** (*Has attachments*)
* Kategorija: general/maintenance/finance/safety/meeting/outage/other
* Period: 7/30/90/Custom range
* Segment: ulaz/sprat (ako postoji)
* Sort override (premium): newest/oldest
* Buttons: **Primijeni** (*Apply*), **Resetuj** (*Reset*)

### 7.6 Pretraga (Stanar)

* Debounce 300ms
* Freemium: title + body
* Premium: title + body + (opc.) OCR attachment index

### 7.7 Stanja (Stanar lista)

* **Loading** (*Loading*): skeleton 8 cards
* **Empty** (*Empty*): “Nema obavještenja” + refresh
* **Empty filtered** (*No results*): “Nema rezultata za filtere” + reset
* **Error** (*Error*): banner + retry
* **Offline** (*Offline*): keš + badge “Offline”

---

## 8) **STANAR — Detalj obavještenja** (*Resident detail*)

### 8.1 Layout

* AppBar: back + overflow
* Body:

  * Title
  * Meta row: datum + badges
  * Body markdown
  * Attachments section
  * Thread section (preview)
* Sticky bottom actions:

  * Primary: **Odgovori upravniku** (*Reply to manager*)
  * Secondary: **Potvrdi prijem** (*Acknowledge*) (samo ako requiresAck && !ackAt)

### 8.2 Pravila read markinga

* `readAt` set kada:

  * time-on-screen ≥ 2s OR
  * scroll progress ≥ 60%
* Ako korisnik odmah izađe (<2s i <60%) → ne setuje read.

### 8.3 Attachments (Stanar)

* Image: inline grid + full screen viewer
* PDF:

  * Freemium: download
  * Premium: inline preview + download
* Video:

  * Freemium: download/open externally
  * Premium: inline player (ako dozvoljeno)

### 8.4 Overflow menu (Stanar)

* **Podijeli** (*Share*) (ako policy dozvoljava)
* **Prijavi problem** (*Report issue*) (log event)
* **Arhiviraj** (*Archive*)

### 8.5 Thread preview (Stanar)

* Sort ASC
* Ako thread zatvoren: composer dugme i dalje postoji ali prikazuje info “Thread zatvoren” i onemogućava slanje.

---

## 9) **STANAR — Composer (bottom sheet)** (*Resident reply composer*)

### 9.1 UI elementi

* Header: “Poruka upravniku”
* Text area + counter
* Attachments strip + add buttons
* CTA **Pošalji** (*Send*)

### 9.2 Validacije

* Tekst 1–1000 OR ≥1 attachment
* Attachment limiti:

  * Freemium: 2 images + 1 PDF, max 10MB/file
  * Premium: 4 images + 2 PDF, max 20MB/file

### 9.3 State mašina

* `idle → validating → sending → success|fail`
* Offline: `pending` queue (ako `ff.notice.offlineQueue=true`)

### 9.4 Error handling

* Upload fail per attachment: prikaz inline na tile + retry
* Send fail: zadržati tekst + attachments + retry

---

## 10) **UPRAVNIK — Lista** (*Manager list*)

### 10.1 Web layout

* Header: title + CTA **Novo obavještenje** (*New notice*)
* Filter panel (left)
* List center
* Optional stats right (premium)

### 10.2 Filter panel (upravnik)

* Status: draft/scheduled/published/retracted/archived
* Prioritet: normal/urgent
* Kategorija
* Segment: building/entrance/floor/group
* Period: created/published/scheduled range
* Toggle: **Ima nove poruke** (*Has new messages*)

### 10.3 Bulk mode (upravnik)

* Enter bulk: checkbox ili “Select” button
* Bulk actions:

  * **Arhiviraj** (*Archive*)
  * **Povuci** (*Retract*) (samo published)
  * **Promijeni kategoriju** (*Change category*)
  * **Export CSV** (*Export CSV*)
  * **Export PDF** (*Export PDF*) (premium)

Pravila:

* Bulk brisanje poruka: ne.
* Bulk brisanje obavještenja: ne (samo arhiva).

### 10.4 Card (upravnik)

* Title
* Status badge
* Target summary
* Schedule/published meta
* Counters: replies, new replies
* Quick actions (hover): edit (draft/scheduled), retract (published), archive

---

## 11) **UPRAVNIK — Wizard kreiranja (4 koraka)** (*Manager creation wizard*)

### 11.1 Korak 1: **Sadržaj** (*Content*)

UI:

* Input **Naslov** (*Title*)
* Input **Podnaslov** (*Subtitle*) (opciono)
* Editor **Sadržaj** (*Body*) — markdown editor
* Template picker (premium)
* Attachments uploader

Validacije:

* Title 3–120
* Body ≥ 10
* Attachments:

  * Freemium: max 3, 20MB/file
  * Premium: max 5, 50MB/file

### 11.2 Korak 2: **Ciljanje** (*Targeting*)

UI:

* Select **Zgrada** (*Building*) required
* Multi-select **Ulaz** (*Entrance*)
* Multi-select **Sprat** (*Floor*)
* Multi-select **Grupa** (*Group*)
* Multi-select **Stan** (*Unit*) (premium ili ako dataset podržava)
* Exclude list (premium)
* Audience estimate chip (server)

Validacije:

* building required
* bar 1 od: entrance/floor/group/unit ili default “svi” u zgradi

### 11.3 Korak 3: **Dodatno** (*Extras*)

UI toggles:

* **Hitno** (*Urgent*)
* **Pinuj** (*Pin*) + trajanje 24/48h + (premium) permanent
* **Traži potvrdu** (*Requires acknowledge*) + (premium) deadline
* **Zakazivanje** (*Schedule*)

  * Freemium: jednokratno
  * Premium: jednokratno + rekurentno
* **Kanali** (*Channels*)

  * In-app uvijek on
  * Push toggle
  * Email toggle
  * SMS toggle (premium)
* **Komentari/poruke** (*Replies*)

  * allow replies on/off (upravnik može zatvoriti thread)

Info chips:

* “Telefon/email opcioni; osloniti se na in-app/push.”

### 11.4 Korak 4: **Pregled i objava** (*Review & publish*)

UI:

* Preview: mobile + web card
* Summary: targeting, schedule, channels, requiresAck
* CTA:

  * **Objavi** (*Publish*)
  * **Zakaži** (*Schedule*)
  * **Sačuvaj nacrt** (*Save draft*)

### 11.5 Autosave i konfliketi

* Autosave draft: on step change + svakih 10s idle
* Konflikt (editVersion mismatch): dialog “Promijenjeno na drugom uređaju” → options: reload / overwrite (premium) / save copy

---

## 12) **UPRAVNIK — Detalj obavještenja + poruke više stanara** (*Manager detail + multi-thread*)

### 12.1 Sekcije

* Header: title + status + primary actions
* Content: body + attachments
* Target summary
* Threads panel: lista konverzacija po stanovima
* (Premium) Stats panel: read/ack/delivery

### 12.2 Thread list (upravnik)

Row elementi:

* `unitLabel`
* last snippet
* last timestamp
* unread badge
* status chip (open/closed)

Filteri:

* **Bez odgovora** (*Unreplied*)
* **Nepročitano** (*Unread*)
* **Zatvoreno** (*Closed*)
* **Sve** (*All*)

Sort:

* default: unread first, potom `lastMessageAt DESC`

### 12.3 Conversation view (upravnik)

* Message list ASC
* Composer:

  * text
  * attachment (1 image/PDF)
  * CTA send
* Actions:

  * **Zatvori thread** (*Close thread*)
  * **Označi pročitano** (*Mark read*)

### 12.4 Akcije nad obavještenjem (upravnik)

* **Uredi** (*Edit*):

  * allowed: draft
  * allowed: scheduled do `scheduleAt - 2min`
  * not allowed: published (alternativa: new version)
* **Povuci** (*Retract*) — published
* **Arhiviraj** (*Archive*) — published/retracted
* **Dupliraj** (*Duplicate*) — freemium (kreira draft copy)
* **Nova verzija** (*New version*) — premium (link old→new)
* **Republish** (*Republish*) — premium (nova instanca)

---

## 13) **Notifikacije (in-app/push/email/SMS)** (*Notification delivery*)

### 13.1 Pravila kanala bez email/telefona

* **In-app** uvijek.
* **Push** samo ako postoji token.
* **Email** samo ako email postoji.
* **SMS** samo premium i ako broj postoji.

### 13.2 Triggeri

* `notice_published` → stanar receive
* `notice_scheduled_fired` → stanar receive
* `manager_replied` → stanar receive
* `resident_replied` → upravnik receive

### 13.3 In-app inbox indikator

* Global badge count u navigation itemu.
* Per notice: unread + ack required.

---

## 14) **Freemium vs Premium — precizna matrica** (*Plan separation matrix*)

### 14.1 Stanar

**Freemium (obavezno):**

* lista + osnovni filteri + pretraga title/body
* detalj + download priloga
* reply upravniku
* potvrda prijema
* push ako token postoji
* offline cache 10

**Premium (dodatno):**

* SMS obavještenja (ako broj postoji)
* inline PDF preview
* veći limiti priloga u poruci
* označi **Važno** (*Important*) + filter
* server arhiva 12 mjeseci + export PDF (lični)
* offline cache 20

### 14.2 Upravnik

**Freemium (obavezno):**

* kreiranje/objava
* jednokratno zakazivanje
* segmentno ciljanje
* threads više stanara + odgovori
* basic CSV export
* duplicate as draft

**Premium (dodatno):**

* rekurentno zakazivanje
* automatizacije podsjetnika
* SMS fallback
* napredna analitika (views/ack/delivery)
* kanban view
* verzionisanje obavještenja
* PDF export + napredni CSV
* assignment (thread assign) ako se aktivira

---

## 15) **Stanja, prazna stanja, error boundary** (*States, empty states, errors*)

### 15.1 Lista

* `loading` skeleton
* `ready`
* `refreshing` (overlay spinner)
* `empty`
* `emptyFiltered`
* `error` (retry)
* `offline` (cache)

### 15.2 Detalj

* `loading`
* `ready`
* `markReadPending`
* `sendingMessage`
* `error` (recover)

### 15.3 Wizard

* `step1..4`
* `submitting`
* `success`
* `fail`

---

## 16) **Validacije i UI error copy** (*Validation and error copy*)

### 16.1 Validacije

* Title 3–120
* Body ≥ 10
* Message: text≥1 OR attachments≥1
* Schedule: `now + 2min` min
* Attachment types: notice `jpg/png/pdf`; message `jpg/png/pdf` (+ video optional)

### 16.2 Standardni error kodovi

* `VAL_TITLE_TOO_SHORT`
* `VAL_BODY_TOO_SHORT`
* `VAL_MESSAGE_EMPTY`
* `VAL_SCHEDULE_IN_PAST`
* `UPLOAD_TOO_LARGE`
* `UPLOAD_TYPE_NOT_ALLOWED`
* `NETWORK_OFFLINE`
* `CONFLICT_EDIT_VERSION`

### 16.3 Snackbars

* “Sačuvano kao nacrt”
* “Obavještenje objavljeno”
* “Obavještenje zakazano”
* “Obavještenje povučeno”
* “Obavještenje arhivirano”
* “Poruka poslata”
* “Potvrda evidentirana”

---

## 17) **Pristupačnost** (*Accessibility*)

* Kontrast ≥ 4.5:1
* Tap target ≥ 44px
* Fokus ring 2px
* `SemanticsLabel` za badgeve
* Dinamični font scaling bez overflow
* Web tastatura:

  * `Ctrl+K` search focus
  * `Esc` close overlays
  * `Ctrl+Enter` send message

---

## 18) **Flutter implementacija** (*Flutter implementation blueprint*)

### 18.1 Folder struktura

`features/notifications/{data,domain,presentation}`

### 18.2 Pages

* `ResidentNotificationsListPage`
* `ResidentNotificationDetailPage`
* `ResidentReplyBottomSheet`
* `ManagerNotificationsListPage`
* `NoticeWizardPage`
* `ManagerNoticeDetailPage`

### 18.3 Widgets

* `NoticeCard`
* `NoticeBadgesRow`
* `NoticeFilterOverlay`
* `NoticeSearchField`
* `MarkdownBody`
* `AttachmentGrid`
* `ThreadList`
* `ConversationView`
* `MessageComposer`

### 18.4 Controllers

* `NotificationsFeedController`
* `NoticeDetailController`
* `NoticeWizardController`
* `ManagerNoticeDetailController`

### 18.5 Offline

* Cache: 10/20
* Queue pending messages (ff)
* Merge: stable sort + id tie-break

---

## 19) **Analitika** (*Analytics*)

Eventi:

* `notice_list_view`
* `notice_filter_apply`
* `notice_search`
* `notice_open`
* `notice_mark_read`
* `notice_ack`
* `notice_message_send`
* `notice_create_draft`
* `notice_publish`
* `notice_schedule`
* `notice_retract`
* `notice_archive`
* `notice_duplicate`
* `notice_version_create` (premium)

Dimenzije:

* `role`, `plan`, `channel`, `segment`, `platform`, `locale`

---

## 20) **QA acceptance** (*QA acceptance*)

### 20.1 Stanar

* Lista: loading/empty/filter/search
* Detalj: read marking + ack
* Reply: send + retry + offline queue
* Attachments: download, preview (premium)

### 20.2 Upravnik

* Wizard: autosave + publish/schedule
* Detalj: threads više stanara + odgovori
* Bulk: archive/retract/export
* Premium: recurring + analytics + sms

— Kraj dokumenta —
